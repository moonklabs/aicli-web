# AICode Manager ì‹œìŠ¤í…œ ìš´ì˜ ê°€ì´ë“œ

## ğŸ“– ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì•„í‚¤í…ì²˜](#ì•„í‚¤í…ì²˜)
3. [ì„¤ì¹˜ ë° ë°°í¬](#ì„¤ì¹˜-ë°-ë°°í¬)
4. [ì„¤ì • ê´€ë¦¬](#ì„¤ì •-ê´€ë¦¬)
5. [ëª¨ë‹ˆí„°ë§](#ëª¨ë‹ˆí„°ë§)
6. [ë°±ì—… ë° ë³µêµ¬](#ë°±ì—…-ë°-ë³µêµ¬)
7. [ë³´ì•ˆ ê´€ë¦¬](#ë³´ì•ˆ-ê´€ë¦¬)
8. [ì„±ëŠ¥ ìµœì í™”](#ì„±ëŠ¥-ìµœì í™”)
9. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)
10. [ìœ ì§€ë³´ìˆ˜](#ìœ ì§€ë³´ìˆ˜)

---

## ğŸ” ì‹œìŠ¤í…œ ê°œìš”

### í”„ë¡œì íŠ¸ ì •ë³´
- **í”„ë¡œì íŠ¸ëª…**: AICode Manager
- **ë²„ì „**: 1.0.0
- **ì–¸ì–´**: Go 1.24+
- **í”„ë ˆì„ì›Œí¬**: Gin Web Framework
- **ë°ì´í„°ë² ì´ìŠ¤**: SQLite/PostgreSQL + Redis
- **ì¸ì¦**: OAuth2.0 + JWT + RBAC

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸
- **API ì„œë²„**: RESTful API ë° WebSocket ì„œë²„
- **ì¸ì¦ ì‹œìŠ¤í…œ**: OAuth2.0, JWT, RBAC í†µí•© ì¸ì¦
- **ì„¸ì…˜ ê´€ë¦¬**: Redis ê¸°ë°˜ ë¶„ì‚° ì„¸ì…˜
- **ë³´ì•ˆ ë¯¸ë“¤ì›¨ì–´**: Rate Limiting, CSRF, XSS ë°©ì–´
- **ëª¨ë‹ˆí„°ë§**: ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ë° ë¡œê¹…

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### ì‹œìŠ¤í…œ êµ¬ì¡°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Load Balancer â”‚    â”‚   Web Frontend  â”‚    â”‚   Mobile App    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚           API Gateway                   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚         AICode Manager API              â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
          â”‚  â”‚   Auth      â”‚  â”‚   WebSocket     â”‚   â”‚
          â”‚  â”‚   Service   â”‚  â”‚   Handler       â”‚   â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
          â”‚  â”‚   User      â”‚  â”‚   Project       â”‚   â”‚
          â”‚  â”‚   Service   â”‚  â”‚   Service       â”‚   â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚            Data Layer                   â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
          â”‚  â”‚ PostgreSQL  â”‚  â”‚     Redis       â”‚   â”‚
          â”‚  â”‚ (Primary DB)â”‚  â”‚   (Sessions)    â”‚   â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
aicli-web/
â”œâ”€â”€ cmd/                    # ì• í”Œë¦¬ì¼€ì´ì…˜ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â””â”€â”€ api/               # API ì„œë²„ ë©”ì¸
â”œâ”€â”€ internal/              # ë‚´ë¶€ íŒ¨í‚¤ì§€
â”‚   â”œâ”€â”€ auth/             # ì¸ì¦ ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ middleware/       # ë¯¸ë“¤ì›¨ì–´
â”‚   â”œâ”€â”€ services/         # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ storage/          # ë°ì´í„° ì €ì¥ì†Œ
â”‚   â””â”€â”€ config/           # ì„¤ì • ê´€ë¦¬
â”œâ”€â”€ docs/                 # ë¬¸ì„œ
â”œâ”€â”€ deploy/               # ë°°í¬ ê´€ë ¨ íŒŒì¼
â””â”€â”€ scripts/              # ìš´ì˜ ìŠ¤í¬ë¦½íŠ¸
```

---

## ğŸš€ ì„¤ì¹˜ ë° ë°°í¬

### ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

#### ìµœì†Œ ìš”êµ¬ì‚¬í•­
- **CPU**: 2 Core
- **Memory**: 4GB RAM
- **Disk**: 20GB SSD
- **OS**: Ubuntu 20.04+ / CentOS 8+ / RHEL 8+

#### ê¶Œì¥ ì‚¬ì–‘
- **CPU**: 4 Core
- **Memory**: 8GB RAM
- **Disk**: 50GB SSD
- **Network**: 1Gbps

### ì‚¬ì „ ì¤€ë¹„

#### 1. Go ì„¤ì¹˜
```bash
# Go 1.24+ ì„¤ì¹˜
wget https://golang.org/dl/go1.24.5.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.24.5.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc
```

#### 2. PostgreSQL ì„¤ì¹˜
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install postgresql postgresql-contrib

# CentOS/RHEL
sudo dnf install postgresql postgresql-server postgresql-contrib
sudo postgresql-setup --initdb
sudo systemctl enable postgresql
sudo systemctl start postgresql
```

#### 3. Redis ì„¤ì¹˜
```bash
# Ubuntu/Debian
sudo apt install redis-server

# CentOS/RHEL
sudo dnf install redis
sudo systemctl enable redis
sudo systemctl start redis
```

### ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬

#### 1. ì†ŒìŠ¤ ì½”ë“œ ë‹¤ìš´ë¡œë“œ
```bash
git clone https://github.com/aicli/aicli-web.git
cd aicli-web
```

#### 2. ì˜ì¡´ì„± ì„¤ì¹˜
```bash
go mod download
go mod verify
```

#### 3. ì„¤ì • íŒŒì¼ ìƒì„±
```bash
cp config/config.example.yaml config/config.yaml
# ì„¤ì • íŒŒì¼ í¸ì§‘ (ë‹¤ìŒ ì„¹ì…˜ ì°¸ì¡°)
```

#### 4. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
```bash
# PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
sudo -u postgres createdb aicli_web
sudo -u postgres createuser aicli_user
sudo -u postgres psql -c "ALTER USER aicli_user WITH PASSWORD 'secure_password';"
sudo -u postgres psql -c "GRANT ALL PRIVILEGES ON DATABASE aicli_web TO aicli_user;"

# ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
make migrate
```

#### 5. ë¹Œë“œ ë° ì‹¤í–‰
```bash
# í”„ë¡œë•ì…˜ ë¹Œë“œ
make build

# ì„œë¹„ìŠ¤ ì‹œì‘
./bin/aicli-api
```

### Dockerë¥¼ ì‚¬ìš©í•œ ë°°í¬

#### 1. Docker Compose ì„¤ì •
```yaml
# docker-compose.prod.yml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "8080:8080"
    environment:
      - DATABASE_URL=postgres://aicli_user:secure_password@postgres:5432/aicli_web
      - REDIS_URL=redis://redis:6379
    depends_on:
      - postgres
      - redis
    restart: unless-stopped

  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: aicli_web
      POSTGRES_USER: aicli_user
      POSTGRES_PASSWORD: secure_password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: unless-stopped

  redis:
    image: redis:7
    volumes:
      - redis_data:/data
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./deploy/nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./deploy/ssl:/etc/ssl/certs
    depends_on:
      - app
    restart: unless-stopped

volumes:
  postgres_data:
  redis_data:
```

#### 2. ë°°í¬ ì‹¤í–‰
```bash
docker-compose -f docker-compose.prod.yml up -d
```

---

## âš™ï¸ ì„¤ì • ê´€ë¦¬

### ì„¤ì • íŒŒì¼ êµ¬ì¡°

#### config/config.yaml
```yaml
# ì„œë²„ ì„¤ì •
server:
  host: "0.0.0.0"
  port: 8080
  read_timeout: 30s
  write_timeout: 30s
  idle_timeout: 120s
  max_header_bytes: 1048576

# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
database:
  driver: "postgres"
  host: "localhost"
  port: 5432
  name: "aicli_web"
  user: "aicli_user"
  password: "${DATABASE_PASSWORD}"
  ssl_mode: "require"
  max_open_conns: 25
  max_idle_conns: 5
  conn_max_lifetime: 300s

# Redis ì„¤ì •
redis:
  addr: "localhost:6379"
  password: "${REDIS_PASSWORD}"
  db: 0
  max_retries: 3
  pool_size: 10
  min_idle_conns: 2

# JWT ì„¤ì •
jwt:
  secret: "${JWT_SECRET}"
  access_token_duration: "15m"
  refresh_token_duration: "24h"
  issuer: "aicli-web"

# OAuth ì„¤ì •
oauth:
  google:
    client_id: "${GOOGLE_CLIENT_ID}"
    client_secret: "${GOOGLE_CLIENT_SECRET}"
    redirect_url: "https://your-domain.com/auth/oauth/google/callback"
  github:
    client_id: "${GITHUB_CLIENT_ID}"
    client_secret: "${GITHUB_CLIENT_SECRET}"
    redirect_url: "https://your-domain.com/auth/oauth/github/callback"

# ë³´ì•ˆ ì„¤ì •
security:
  rate_limit:
    requests_per_second: 100
    burst_size: 200
    window_size: "1m"
  cors:
    allowed_origins: ["https://your-domain.com"]
    allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
    allowed_headers: ["Authorization", "Content-Type"]
    max_age: 86400

# ë¡œê¹… ì„¤ì •
logging:
  level: "info"
  format: "json"
  output: "stdout"
  file:
    enabled: true
    path: "/var/log/aicli-web/app.log"
    max_size: 100
    max_backups: 10
    max_age: 30

# ëª¨ë‹ˆí„°ë§ ì„¤ì •
monitoring:
  metrics:
    enabled: true
    path: "/metrics"
  health:
    enabled: true
    path: "/health"
```

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

#### .env íŒŒì¼
```bash
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_PASSWORD=your_secure_database_password

# Redis
REDIS_PASSWORD=your_secure_redis_password

# JWT
JWT_SECRET=your_super_secret_jwt_key_at_least_32_characters

# OAuth
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret

# ê¸°íƒ€
APP_ENV=production
LOG_LEVEL=info
```

### ì„¤ì • ê²€ì¦
```bash
# ì„¤ì • íŒŒì¼ ê²€ì¦
make config-validate

# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
make env-check
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### í—¬ìŠ¤ ì²´í¬

#### ê¸°ë³¸ í—¬ìŠ¤ ì²´í¬
```bash
curl http://localhost:8080/health
```

ì‘ë‹µ ì˜ˆì‹œ:
```json
{
  "status": "healthy",
  "timestamp": "2024-01-01T12:00:00Z",
  "services": {
    "database": "healthy",
    "redis": "healthy",
    "auth": "healthy"
  }
}
```

#### ìƒì„¸ í—¬ìŠ¤ ì²´í¬
```bash
curl http://localhost:8080/health/detailed
```

### ë©”íŠ¸ë¦­ ìˆ˜ì§‘

#### Prometheus ë©”íŠ¸ë¦­
```bash
curl http://localhost:8080/metrics
```

ì£¼ìš” ë©”íŠ¸ë¦­:
- `http_requests_total`: ì´ HTTP ìš”ì²­ ìˆ˜
- `http_request_duration_seconds`: HTTP ìš”ì²­ ì²˜ë¦¬ ì‹œê°„
- `active_sessions_total`: í™œì„± ì„¸ì…˜ ìˆ˜
- `auth_attempts_total`: ì¸ì¦ ì‹œë„ íšŸìˆ˜
- `database_connections_active`: í™œì„± DB ì—°ê²° ìˆ˜

#### ë¡œê·¸ ëª¨ë‹ˆí„°ë§
```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
tail -f /var/log/aicli-web/app.log

# ì—ëŸ¬ ë¡œê·¸ í•„í„°ë§
grep "ERROR" /var/log/aicli-web/app.log

# ì¸ì¦ ì‹¤íŒ¨ ë¡œê·¸
grep "auth_failed" /var/log/aicli-web/app.log
```

### Grafana ëŒ€ì‹œë³´ë“œ

#### ì£¼ìš” íŒ¨ë„
1. **ì‹œìŠ¤í…œ ìƒíƒœ**: CPU, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
2. **ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”íŠ¸ë¦­**: ìš”ì²­ ìˆ˜, ì‘ë‹µ ì‹œê°„, ì—ëŸ¬ìœ¨
3. **ì¸ì¦ í†µê³„**: ë¡œê·¸ì¸ ì„±ê³µ/ì‹¤íŒ¨, í™œì„± ì‚¬ìš©ì
4. **ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥**: ì¿¼ë¦¬ ì‹œê°„, ì—°ê²° ìˆ˜
5. **ë³´ì•ˆ ì´ë²¤íŠ¸**: ì˜ì‹¬ìŠ¤ëŸ¬ìš´ í™œë™, Rate Limit ìœ„ë°˜

---

## ğŸ’¾ ë°±ì—… ë° ë³µêµ¬

### ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…

#### ìë™ ë°±ì—… ìŠ¤í¬ë¦½íŠ¸
```bash
#!/bin/bash
# backup.sh

BACKUP_DIR="/backup/aicli-web"
DATE=$(date +"%Y%m%d_%H%M%S")
DB_NAME="aicli_web"

# ë°±ì—… ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p $BACKUP_DIR

# PostgreSQL ë°±ì—…
pg_dump -h localhost -U aicli_user -d $DB_NAME | gzip > $BACKUP_DIR/db_backup_$DATE.sql.gz

# Redis ë°±ì—…
redis-cli --rdb $BACKUP_DIR/redis_backup_$DATE.rdb

# ì˜¤ë˜ëœ ë°±ì—… íŒŒì¼ ì •ë¦¬ (30ì¼ ì´ìƒ)
find $BACKUP_DIR -name "*.gz" -mtime +30 -delete
find $BACKUP_DIR -name "*.rdb" -mtime +30 -delete

echo "Backup completed: $DATE"
```

#### ë°±ì—… ìŠ¤ì¼€ì¤„ë§
```bash
# crontab ì„¤ì •
# ë§¤ì¼ 2ì‹œì— ë°±ì—… ì‹¤í–‰
0 2 * * * /opt/aicli-web/scripts/backup.sh >> /var/log/backup.log 2>&1
```

### ë°ì´í„° ë³µêµ¬

#### PostgreSQL ë³µêµ¬
```bash
# ì „ì²´ ë³µêµ¬
gunzip -c /backup/aicli-web/db_backup_20240101_020000.sql.gz | psql -h localhost -U aicli_user -d aicli_web

# íŠ¹ì • í…Œì´ë¸” ë³µêµ¬
pg_restore -h localhost -U aicli_user -d aicli_web -t users /backup/aicli-web/db_backup_20240101_020000.sql.gz
```

#### Redis ë³µêµ¬
```bash
# Redis ì„œë¹„ìŠ¤ ì¤‘ì§€
sudo systemctl stop redis

# ë°±ì—… íŒŒì¼ ë³µì›
cp /backup/aicli-web/redis_backup_20240101_020000.rdb /var/lib/redis/dump.rdb
chown redis:redis /var/lib/redis/dump.rdb

# Redis ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start redis
```

---

## ğŸ”’ ë³´ì•ˆ ê´€ë¦¬

### SSL/TLS ì„¤ì •

#### Let's Encrypt ì¸ì¦ì„œ ì„¤ì •
```bash
# Certbot ì„¤ì¹˜
sudo apt install certbot

# ì¸ì¦ì„œ ë°œê¸‰
sudo certbot certonly --standalone -d your-domain.com

# ìë™ ê°±ì‹  ì„¤ì •
echo "0 12 * * * /usr/bin/certbot renew --quiet" | sudo crontab -
```

#### Nginx SSL ì„¤ì •
```nginx
server {
    listen 443 ssl http2;
    server_name your-domain.com;

    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;
    
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;
    
    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### ë°©í™”ë²½ ì„¤ì •
```bash
# UFW ë°©í™”ë²½ ì„¤ì •
sudo ufw enable
sudo ufw default deny incoming
sudo ufw default allow outgoing

# í•„ìš”í•œ í¬íŠ¸ë§Œ í—ˆìš©
sudo ufw allow 22/tcp      # SSH
sudo ufw allow 80/tcp      # HTTP
sudo ufw allow 443/tcp     # HTTPS

# ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì—ì„œë§Œ DB ì ‘ê·¼ í—ˆìš©
sudo ufw allow from 10.0.0.0/8 to any port 5432
sudo ufw allow from 10.0.0.0/8 to any port 6379
```

### ì •ê¸° ë³´ì•ˆ ì ê²€
```bash
#!/bin/bash
# security_check.sh

echo "===== Security Check Report ====="
echo "Date: $(date)"
echo

# 1. ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ í™•ì¸
echo "1. System Updates:"
apt list --upgradable 2>/dev/null | wc -l

# 2. ì‹¤íŒ¨í•œ ë¡œê·¸ì¸ ì‹œë„ í™•ì¸
echo "2. Failed Login Attempts (last 24h):"
grep "auth_failed" /var/log/aicli-web/app.log | tail -10

# 3. ì˜ì‹¬ìŠ¤ëŸ¬ìš´ IP í™•ì¸
echo "3. Suspicious IPs:"
grep "rate_limit_exceeded" /var/log/aicli-web/app.log | awk '{print $4}' | sort | uniq -c | sort -nr | head -5

# 4. SSL ì¸ì¦ì„œ ë§Œë£Œì¼ í™•ì¸
echo "4. SSL Certificate Expiry:"
openssl x509 -in /etc/letsencrypt/live/your-domain.com/cert.pem -noout -dates

echo "===== End of Report ====="
```

---

## âš¡ ì„±ëŠ¥ ìµœì í™”

### ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

#### PostgreSQL íŠœë‹
```sql
-- postgresql.conf ì„¤ì •
shared_buffers = 256MB
effective_cache_size = 1GB
maintenance_work_mem = 64MB
checkpoint_completion_target = 0.9
wal_buffers = 16MB
default_statistics_target = 100
random_page_cost = 1.1
effective_io_concurrency = 200

-- ì¸ë±ìŠ¤ ìµœì í™”
CREATE INDEX CONCURRENTLY idx_users_email ON users(email);
CREATE INDEX CONCURRENTLY idx_sessions_user_id ON sessions(user_id);
CREATE INDEX CONCURRENTLY idx_projects_owner_id ON projects(owner_id);
```

#### ì¿¼ë¦¬ ìµœì í™”
```bash
# ëŠë¦° ì¿¼ë¦¬ ë¡œê·¸ í™œì„±í™”
echo "log_min_duration_statement = 1000" >> /etc/postgresql/13/main/postgresql.conf

# ì¿¼ë¦¬ ë¶„ì„
psql -U aicli_user -d aicli_web -c "EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'user@example.com';"
```

### Redis ìµœì í™”
```redis
# redis.conf ì„¤ì •
maxmemory 512mb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
save 60 10000
```

### ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì í™”

#### ì—°ê²° í’€ íŠœë‹
```go
// database.go
db.SetMaxOpenConns(25)
db.SetMaxIdleConns(5)
db.SetConnMaxLifetime(5 * time.Minute)
```

#### ìºì‹± ì „ëµ
```go
// ì„¸ì…˜ ìºì‹±
cache.Set("session:"+sessionID, sessionData, 15*time.Minute)

// ì‚¬ìš©ì ì •ë³´ ìºì‹±
cache.Set("user:"+userID, userData, 5*time.Minute)
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œì™€ í•´ê²°ë°©ë²•

#### 1. ì„œë¹„ìŠ¤ ì‹œì‘ ì‹¤íŒ¨
```bash
# ë¡œê·¸ í™•ì¸
journalctl -u aicli-web -f

# ì„¤ì • íŒŒì¼ ê²€ì¦
./bin/aicli-api --config-check

# í¬íŠ¸ ì‚¬ìš© ì¤‘ í™•ì¸
netstat -tulpn | grep :8080
```

#### 2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜
```bash
# PostgreSQL ìƒíƒœ í™•ì¸
sudo systemctl status postgresql

# ì—°ê²° í…ŒìŠ¤íŠ¸
psql -h localhost -U aicli_user -d aicli_web -c "SELECT 1;"

# ì—°ê²° ìˆ˜ í™•ì¸
psql -U postgres -c "SELECT count(*) FROM pg_stat_activity;"
```

#### 3. Redis ì—°ê²° ì˜¤ë¥˜
```bash
# Redis ìƒíƒœ í™•ì¸
sudo systemctl status redis

# ì—°ê²° í…ŒìŠ¤íŠ¸
redis-cli ping

# ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
redis-cli info memory
```

#### 4. ì¸ì¦ ë¬¸ì œ
```bash
# JWT í† í° ê²€ì¦
echo "your_jwt_token" | base64 -d

# ì„¸ì…˜ í™•ì¸
redis-cli keys "session:*"

# OAuth ì„¤ì • í™•ì¸
curl -I https://accounts.google.com/o/oauth2/auth
```

### ë¡œê·¸ ë¶„ì„

#### ì—ëŸ¬ íŒ¨í„´ ë¶„ì„
```bash
# HTTP 5xx ì—ëŸ¬
grep "status\":5" /var/log/aicli-web/app.log | jq '.timestamp, .status, .error'

# ë°ì´í„°ë² ì´ìŠ¤ ì—ëŸ¬
grep "database" /var/log/aicli-web/app.log | grep -i error

# ì¸ì¦ ì‹¤íŒ¨
grep "auth_failed" /var/log/aicli-web/app.log | jq '.timestamp, .user_id, .ip'
```

---

## ğŸ› ï¸ ìœ ì§€ë³´ìˆ˜

### ì •ê¸° ì ê²€ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### ì¼ì¼ ì ê²€
- [ ] ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ (CPU, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬)
- [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ í™•ì¸
- [ ] ì—ëŸ¬ìœ¨ ë° ì‘ë‹µì‹œê°„ í™•ì¸
- [ ] ë°±ì—… ìƒíƒœ í™•ì¸

#### ì£¼ê°„ ì ê²€
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ ë¶„ì„
- [ ] ë³´ì•ˆ ë¡œê·¸ ê²€í† 
- [ ] ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ í™•ì¸
- [ ] ì¸ì¦ì„œ ë§Œë£Œì¼ í™•ì¸

#### ì›”ê°„ ì ê²€
- [ ] ì „ì²´ ì‹œìŠ¤í…œ ë³´ì•ˆ ê°ì‚¬
- [ ] ì„±ëŠ¥ ìµœì í™” ê²€í† 
- [ ] ë°±ì—…/ë³µêµ¬ í…ŒìŠ¤íŠ¸
- [ ] ìš©ëŸ‰ ê³„íš ê²€í† 

### ì—…ë°ì´íŠ¸ ì ˆì°¨

#### 1. ì¤€ë¹„ ë‹¨ê³„
```bash
# í˜„ì¬ ë²„ì „ ë°±ì—…
./bin/aicli-api --version > /backup/current_version.txt
pg_dump aicli_web > /backup/pre_update_db.sql

# ì˜ì¡´ì„± í™•ì¸
go mod verify
```

#### 2. ë°°í¬ ë‹¨ê³„
```bash
# Blue-Green ë°°í¬
# 1. ìƒˆ ë²„ì „ ë°°í¬
docker-compose -f docker-compose.blue.yml up -d

# 2. í—¬ìŠ¤ì²´í¬
curl http://blue-instance:8080/health

# 3. íŠ¸ë˜í”½ ì „í™˜
# Load balancer ì„¤ì • ë³€ê²½

# 4. ì´ì „ ë²„ì „ ì¢…ë£Œ
docker-compose -f docker-compose.green.yml down
```

#### 3. ê²€ì¦ ë‹¨ê³„
```bash
# ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
make test-integration

# ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
make test-performance

# ë¡œê·¸ ëª¨ë‹ˆí„°ë§
tail -f /var/log/aicli-web/app.log | grep -i error
```

### ë¡¤ë°± ì ˆì°¨
```bash
# 1. íŠ¸ë˜í”½ ì°¨ë‹¨
# Load balancerì—ì„œ íŠ¸ë˜í”½ ì°¨ë‹¨

# 2. ì´ì „ ë²„ì „ìœ¼ë¡œ ë³µì›
docker-compose -f docker-compose.green.yml up -d

# 3. ë°ì´í„°ë² ì´ìŠ¤ ë³µì› (í•„ìš”ì‹œ)
psql aicli_web < /backup/pre_update_db.sql

# 4. íŠ¸ë˜í”½ ë³µì›
# Load balancer ì„¤ì • ì›ë³µ
```

---

## ğŸ“ ì§€ì› ë° ì—°ë½ì²˜

### ê¸°ìˆ  ì§€ì›
- **ì´ë©”ì¼**: tech-support@aicli.dev
- **ìŠ¬ë™**: #aicli-support
- **ì´ìŠˆ íŠ¸ë˜ì»¤**: https://github.com/aicli/aicli-web/issues

### ê¸´ê¸‰ ì—°ë½ì²˜
- **ìš´ì˜íŒ€**: +82-10-1234-5678
- **ë³´ì•ˆíŒ€**: security@aicli.dev
- **ì˜¨ì½œ ë‹´ë‹¹ì**: oncall@aicli.dev

### ìœ ìš©í•œ ë§í¬
- **ê°œë°œì ë¬¸ì„œ**: https://docs.aicli.dev
- **API ë¬¸ì„œ**: https://api-docs.aicli.dev
- **ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ**: https://monitor.aicli.dev
- **ìƒíƒœ í˜ì´ì§€**: https://status.aicli.dev

---

*ì´ ë¬¸ì„œëŠ” ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. ìµœì‹  ë²„ì „ì€ í”„ë¡œì íŠ¸ ì €ì¥ì†Œì—ì„œ í™•ì¸í•˜ì„¸ìš”.*