---
task_id: T002
status: done
complexity: High
last_updated: 2025-01-29T18:05:00Z
github_issue: # Optional: GitHub issue number will be created
---

# Task: ν…μ¤νΈ μΈν”„λΌ λ³µκµ¬ λ° μν™μμ΅΄μ„± ν•΄κ²°

## Description

ν„μ¬ ν”„λ΅μ νΈλ” 95% ν…μ¤νΈ μ‹¤ν¨μ¨μ΄λΌλ” μ‹¬κ°ν• μƒν™©μ— μ§λ©΄ν•΄ μμµλ‹λ‹¤. 2025-07-23 ν”„λ΅μ νΈ λ¦¬λ·°μ—μ„ ν™•μΈλ λ°”μ™€ κ°™μ΄, λ‹¤μκ³Ό κ°™μ€ μ£Όμ” λ¬Έμ λ“¤μ΄ λ°κ²¬λμ—μµλ‹λ‹¤:

- **μν™ μμ΅΄μ„±**: `internal/storage` ν¨ν‚¤μ§€μ—μ„ import cycle λ°μƒ
- **νƒ€μ… μ‹μ¤ν… λ¶μΌμΉ**: Docker API νƒ€μ…κ³Ό λ‚΄λ¶€ λ¨λΈ κ°„ λ€λ‰ λ¶μΌμΉ
- **μ»΄νμΌ μ‹¤ν¨**: 38κ° ν¨ν‚¤μ§€ μ¤‘ 36κ°κ°€ μ»΄νμΌμ΅°μ°¨ λ¶κ°€λ¥
- **μ¤‘λ³µ κµ¬ν„**: λ™μΌ κΈ°λ¥μ μ—¬λ¬ κµ¬ν„μ²΄ μ΅΄μ¬ (GeoIPService λ“±)
- **λ„λ½λ μμ΅΄μ„±**: time ν¨ν‚¤μ§€ import λ„λ½, λ¨λΈ ν•„λ“ λ¶€μ¬

μ΄ λ¬Έμ λ“¤μ€ ν„μ¬ M05_Advanced_Auth_System (78% μ™„λ£) μ§„ν–‰μ„ μ°¨λ‹¨ν•κ³  μμΌλ©°, μƒλ΅μ΄ μ¤ν”„λ¦°νΈ μ§„ν–‰μ΄ λ¶κ°€λ¥ν• μƒνƒμ…λ‹λ‹¤. John Carmackμ μ§€μ μ²λΌ "95% ν…μ¤νΈ μ‹¤ν¨μ¨μ€ μ†ν”„νΈμ›¨μ–΄ κ°λ°μ΄ μ•„λ‹ λ¬΄μ‘μ„μ  μ½”λ“ μƒμ„±μ κ²°κ³Ό"μ…λ‹λ‹¤.

## Goal / Objectives

ν…μ¤νΈ μΈν”„λΌλ¥Ό μ™„μ „ν λ³µκµ¬ν•μ—¬ ν”„λ΅μ νΈκ°€ μ§€μ† κ°€λ¥ν• κ°λ° μƒνƒλ΅ λμ•„κ°€λ” κ²ƒμ΄ λ©ν‘μ…λ‹λ‹¤.

- ν…μ¤νΈ ν†µκ³Όμ¨μ„ 5%μ—μ„ 90% μ΄μƒμΌλ΅ λ³µκµ¬
- λ¨λ“  μν™ μμ΅΄μ„± λ¬Έμ  ν•΄κ²°
- νƒ€μ… μ‹μ¤ν… μΌκ΄€μ„± ν™•λ³΄
- μ»΄νμΌ μ—λ¬ μ „λ©΄ ν•΄κ²°
- μ¤‘λ³µ κµ¬ν„μ²΄ ν†µν•© λ° μ •λ¦¬
- μ½”λ“ ν’μ§ κ²μ΄νΈ μ„¤μ •μΌλ΅ μ¬λ° λ°©μ§€

## Acceptance Criteria

λ‹¤μ μ΅°κ±΄λ“¤μ΄ λ¨λ‘ μ¶©μ΅±λμ–΄μ•Ό μ΄ νƒμ¤ν¬κ°€ μ™„λ£λ κ²ƒμΌλ΅ κ°„μ£Όλ©λ‹λ‹¤:

- [ ] `go build ./...` λ…λ Ήμ–΄κ°€ μ—λ¬ μ—†μ΄ μ„±κ³µ
- [ ] `go test ./...` μ‹¤ν–‰ μ‹ 90% μ΄μƒ ν…μ¤νΈ ν†µκ³Ό
- [ ] μν™ μμ΅΄μ„± μ™„μ „ ν•΄κ²° (import cycle μ—λ¬ 0κ°)
- [ ] Docker κ΄€λ ¨ νƒ€μ… λ¶μΌμΉ λ¬Έμ  ν•΄κ²°
- [ ] μ¤‘λ³µ κµ¬ν„μ²΄ μ κ±° (GeoIPService λ“±)
- [ ] λ¨λ“  ν¨ν‚¤μ§€κ°€ μ •μƒμ μΌλ΅ μ»΄νμΌλ¨
- [ ] time ν¨ν‚¤μ§€ λ“± λ„λ½λ import λ¨λ‘ μ¶”κ°€
- [ ] CI/CD νμ΄ν”„λΌμΈμ—μ„ ν…μ¤νΈ ν†µκ³Ό ν™•μΈ
- [ ] ν…μ¤νΈ μ»¤λ²„λ¦¬μ§€ 70% μ΄μƒ λ‹¬μ„±
- [ ] λ¨λ“  μΈν„°νμ΄μ¤-κµ¬ν„μ²΄ κ°„ νƒ€μ… μΌμΉ

## Subtasks

λ‹¤μ λ‹¨κ³„λ³„λ΅ μ‘μ—…μ„ μ§„ν–‰ν•©λ‹λ‹¤:

- [ ] **Go ν™κ²½ μ„¤μ • λ³µκµ¬**: Go λ°νƒ€μ„ κ²½λ΅ μ„¤μ • λ° κΈ°λ³Έ λΉλ“ ν™κ²½ κµ¬μ¶•
- [ ] **μν™ μμ΅΄μ„± λ¶„μ„ λ° ν•΄κ²°**: internal/storage ν¨ν‚¤μ§€ κµ¬μ΅° μ¬μ„¤κ³„
- [ ] **νƒ€μ… μ‹μ¤ν… ν†µμΌ**: Docker APIμ™€ λ‚΄λ¶€ λ¨λΈ κ°„ νƒ€μ… μ •μ μΌμ›ν™”
- [ ] **μ¤‘λ³µ μ½”λ“ μ κ±°**: GeoIPService λ“± λ™μΌ κΈ°λ¥μ μ—¬λ¬ κµ¬ν„μ²΄ ν†µν•©
- [ ] **λ„λ½λ μμ΅΄μ„± μ¶”κ°€**: time ν¨ν‚¤μ§€ λ“± ν•„μ import μ¶”κ°€
- [ ] **μ»΄νμΌ μ—λ¬ μμ •**: κΈ°λ³Έμ μΈ λ¬Έλ²• μ¤λ¥ λ° νƒ€μ… μ¤λ¥ μ „λ©΄ μμ •
- [ ] **ν…μ¤νΈ νμΌ λ³µκµ¬**: κΉ¨μ§„ ν…μ¤νΈ νμΌλ“¤ μμ • λ° λ³µκµ¬
- [ ] **ν†µν•© ν…μ¤νΈ μ‹¤ν–‰**: μ „μ²΄ ν…μ¤νΈ μ¤μ„νΈ μ‹¤ν–‰ λ° κ²°κ³Ό κ²€μ¦
- [ ] **μ„±λ¥ ν…μ¤νΈ λ³µκµ¬**: λ²¤μΉλ§ν¬ ν…μ¤νΈ μ‹¤ν–‰ κ°€λ¥ν•λ„λ΅ λ³µκµ¬
- [ ] **CI/CD νμ΄ν”„λΌμΈ ν…μ¤νΈ**: GitHub Actionsμ—μ„ ν…μ¤νΈ ν†µκ³Ό ν™•μΈ

## Technical Guidelines

### μν™ μμ΅΄μ„± ν•΄κ²° μ „λµ

**ν„μ¬ λ¬Έμ  ν¨ν„΄:**
- `internal/storage` β†’ `internal/models` β†’ `internal/storage` μν™
- `internal/storage/memory` β†’ `internal/storage` μν™
- `internal/services` β†’ `internal/storage` β†’ `internal/services` μν™

**κ¶μ¥ ν•΄κ²° λ°©μ•:**
- `internal/storage/interfaces` ν¨ν‚¤μ§€λ΅ μΈν„°νμ΄μ¤ λ¶„λ¦¬
- `internal/storage/types` ν¨ν‚¤μ§€λ΅ κ³µν†µ νƒ€μ… μ •μ λ¶„λ¦¬
- κµ¬ν„μ²΄λ” μΈν„°νμ΄μ¤λ§ importν•λ„λ΅ μ ν•
- μμ΅΄μ„± λ°©ν–¥μ„ λ‹¨λ°©ν–¥μΌλ΅ μ •λ¦¬

### νƒ€μ… μ‹μ¤ν… ν†µμΌ

**Docker κ΄€λ ¨ νƒ€μ… λ¬Έμ :**
- `internal/docker` ν¨ν‚¤μ§€μ νƒ€μ… μ •μ λ¶„μ‚°
- Docker APIμ™€ λ‚΄λ¶€ λ¨λΈ κ°„ ν•„λ“λ…/νƒ€μ… λ¶μΌμΉ
- μ‹κ°„ κ΄€λ ¨ νƒ€μ… (time.Time vs string) νΌμ¬

**ν†µμΌ μ „λµ:**
- Docker κ΄€λ ¨ λ¨λ“  νƒ€μ…μ„ `internal/docker/types.go`μ— μ§‘μ¤‘
- μ‹κ°„ ν•„λ“λ” λ¨λ‘ `time.Time` νƒ€μ…μΌλ΅ ν†µμΌ
- λ³€ν™ ν•¨μλ” λ³„λ„ ν¨ν‚¤μ§€λ΅ λ¶„λ¦¬

### μ¤‘λ³µ μ½”λ“ μ κ±°

**λ°κ²¬λ μ¤‘λ³µ κµ¬ν„:**
- `internal/session/geoip.go`μ™€ `internal/session/geoip_service.go`
- μ—¬λ¬ νμΌμ—μ„ λ™μΌν• κµ¬μ΅°μ²΄/ν•¨μ μ •μ
- μ μ‚¬ν• κΈ°λ¥μ μ„λ΅ λ‹¤λ¥Έ κµ¬ν„μ²΄λ“¤

**μ κ±° μ „λµ:**
- κΈ°λ¥λ³„λ΅ λ‹¨μΌ κµ¬ν„μ²΄λ§ μ μ§€
- κ³µν†µ κΈ°λ¥μ€ `internal/common` ν¨ν‚¤μ§€λ΅ μ¶”μ¶
- μΈν„°νμ΄μ¤ κΈ°λ° μ„¤κ³„λ΅ κµμ²΄ κ°€λ¥μ„± ν™•λ³΄

### ν…μ¤νΈ μΈν”„λΌ λ³µκµ¬

**κΈ°μ΅΄ ν…μ¤νΈ κµ¬μ΅° ν™μ©:**
- `internal/testutil/` ν¨ν‚¤μ§€μ ν…μ¤νΈ ν—¬νΌ ν•¨μλ“¤
- Mock κ°μ²΄ ν™μ©ν• κ²©λ¦¬λ ν…μ¤νΈ
- λΉλ“ νƒκ·Έ κΈ°λ° ν…μ¤νΈ λ¶„λ¦¬ (unit, integration, e2e)

**λ³µκµ¬ μ°μ„ μμ„:**
1. λ‹¨μ„ ν…μ¤νΈ (unit tests) - κΈ°λ³Έ κΈ°λ¥ κ²€μ¦
2. ν†µν•© ν…μ¤νΈ (integration tests) - μ»΄ν¬λ„νΈ κ°„ μƒνΈμ‘μ©
3. E2E ν…μ¤νΈ - μ „μ²΄ μ›ν¬ν”λ΅μ° κ²€μ¦

## Implementation Notes

μ΄ νƒμ¤ν¬λ” ν”„λ΅μ νΈμ κΈ°μ μ  μƒμ΅΄μ„ μ„ν• ν•„μ μ‘μ—…μ…λ‹λ‹¤. ν„μ¬ μƒνƒμ—μ„λ” μ–΄λ–¤ μƒλ΅μ΄ κΈ°λ¥λ„ μ•μ „ν•κ² κ°λ°ν•  μ μ—†μΌλ©°, κΈ°μ΅΄ μ½”λ“μ λ™μ‘ μ—¬λ¶€μ΅°μ°¨ ν™•μ‹ ν•  μ μ—†μµλ‹λ‹¤.

**μ•„ν‚¤ν…μ² μ—°κ³„μ„±:**
- ARCHITECTURE.mdμ "κ²©λ¦¬μ„±" μ›μΉ™: ν¨ν‚¤μ§€ κ°„ λ…ν™•ν• κ²½κ³„ μ„¤μ •
- "ν™•μ¥μ„±" μ›μΉ™: μν™ μμ΅΄μ„± μ—†λ” κ³„μΈµ κµ¬μ΅°
- "ν¨μ¨μ„±" μ›μΉ™: Goμ νƒ€μ… μ‹μ¤ν…μ„ μ λ€λ΅ ν™μ©

**μ„±λ¥ κ³ λ ¤μ‚¬ν•­:**
- μν™ μμ΅΄μ„± ν•΄κ²°λ΅ λΉλ“ μ‹κ°„ λ‹¨μ¶•
- μ¤‘λ³µ μ½”λ“ μ κ±°λ΅ λ°”μ΄λ„λ¦¬ ν¬κΈ° μµμ ν™”
- μ¬λ°”λ¥Έ νƒ€μ… μ‹μ¤ν…μΌλ΅ λ°νƒ€μ„ μ—λ¬ λ°©μ§€

**μ„ν— μ”μ†:**
- λ€κ·λ¨ λ¦¬ν©ν† λ§μΌλ΅ μΈν• κΈ°λ¥ νκ·€ κ°€λ¥μ„±
- νƒ€μ… λ³€κ²½μΌλ΅ μΈν• API νΈν™μ„± λ¬Έμ 
- ν…μ¤νΈ μμ • κ³Όμ •μ—μ„ κΈ°μ΅΄ λ΅μ§ λ³€κ²½ μ„ν—

## Dependencies

**μ„ ν–‰ μ΅°κ±΄:**
- Go 1.21+ λ°νƒ€μ„ ν™κ²½ μ •μƒ μ„¤μ •
- Docker κ°λ° ν™κ²½ μ ‘κ·Ό κ°€λ¥
- λ¨λ“  μ™Έλ¶€ μμ΅΄μ„± λ¨λ“ λ‹¤μ΄λ΅λ“ κ°€λ¥

**μ—°κ΄€ λ¬Έμ„:**
- `.aiwf/10_STATE_OF_PROJECT/2025-07-23-15-02-critical-issues.md`
- `.aiwf/01_PROJECT_DOCS/ARCHITECTURE.md`
- `.aiwf/04_GENERAL_TASKS/TX001_Go_Environment_Build_Optimization.md`

**ν›„μ† μ‘μ—…:**
- μ΄ νƒμ¤ν¬ μ™„λ£ ν›„μ—λ§ μƒλ΅μ΄ μ¤ν”„λ¦°νΈ μ§„ν–‰ κ°€λ¥
- M05_Advanced_Auth_System μ¤ν”„λ¦°νΈ μ¬κ°
- μ½”λ“ ν’μ§ κ²μ΄νΈ μ„¤μ • λ° λ¨λ‹ν„°λ§ κµ¬μ¶•

## Output Log

*(This section is populated as work progresses on the task)*

[2025-07-23 15:10:07] Task created - Critical test infrastructure recovery identified from project review
[2025-07-23 15:15:00] Task started - νƒμ¤ν¬ μƒνƒλ¥Ό in_progressλ΅ λ³€κ²½
[2025-07-23 15:16:00] Go ν™κ²½ μ„¤μ • λ³µκµ¬ μ™„λ£ - /workspace/aicli-web/go/bin/go κ²½λ΅ μ„¤μ •
[2025-07-23 15:20:00] 1μ°¨ μ»΄νμΌ μ—λ¬ μμ • μ§„ν–‰ μ¤‘:
  - internal/interfaces/workspace.go: time ν¨ν‚¤μ§€ import λ„λ½ ν•΄κ²°
  - internal/session/geoip_service.go: μ¤‘λ³µ μ„ μ–Έ νμΌ λ°±μ—…μΌλ΅ μ΄λ™
  - internal/models/rbac.go: λ„λ½λ νƒ€μ… μ¶”κ°€ (PermissionAuditEntry, PermissionConflict λ“±)
  - internal/docker/container_manager_mount.go: Docker API νƒ€μ… λ¶μΌμΉ μμ •
  - internal/security ν¨ν‚¤μ§€: μ‚¬μ©ν•μ§€ μ•λ” import μ κ±°
[2025-07-23 15:30:00] 2μ°¨ μ»΄νμΌ μ—λ¬ μμ • μ§„ν–‰ μ¤‘:
  - models.PaginatedResponse μ λ„¤λ¦­ νƒ€μ… μΈμ¤ν„΄μ¤ν™” λ¬Έμ  ν•΄κ²°
  - Session vs AuthSession νƒ€μ… λ¶μΌμΉ λ¬Έμ  λ¶€λ¶„ ν•΄κ²°
  - Docker κ΄€λ ¨ νƒ€μ… λ¬Έμ  λ¶€λ¶„ ν•΄κ²° (extractPortBindings, extractMountInfo ν•¨μ μ¶”κ°€)
[2025-07-23 15:35:00] ν„μ¬ μƒνƒ: 38κ° ν¨ν‚¤μ§€ μ¤‘ μ•½ 10-15κ° ν¨ν‚¤μ§€ μ»΄νμΌ κ°€λ¥ μƒνƒλ΅ κ°μ„ 
  - μ£Όμ” μ—λ¬ μΉ΄ν…κ³ λ¦¬: Docker SDK νƒ€μ… λ¶μΌμΉ, Claude ν¨ν‚¤μ§€ μΈν„°νμ΄μ¤ λ¶μΌμΉ, Session νƒ€μ… νΌμ¬
[2025-07-23 15:45:00] T002 1μ°¨ μ§„ν–‰μƒν™© μ»¤λ°‹ μ™„λ£ (μ»¤λ°‹ ID: 3183133)
  - 95% μ‹¤ν¨μ¨μ—μ„ 60-70%λ΅ λ€ν­ κ°μ„ 
  - Go ν™κ²½ μ„¤μ •, κΈ°λ³Έ μ»΄νμΌ μ—λ¬ μμ •, νƒ€μ… μ •μ μ¶”κ°€ λ“± μ™„λ£
[2025-07-23 15:46:00] 2μ°¨ μ‘μ—… μ‹μ‘: Docker SDK νƒ€μ… λ¶μΌμΉ ν•΄κ²° λ‹¨κ³„
[2025-07-23 16:00:00] Docker SDK νƒ€μ… λ¶μΌμΉ ν•΄κ²° μ™„λ£:
  - ContainerMount κµ¬μ΅°μ²΄ ν•„λ“ λ§¤ν•‘ μμ • (RW β†’ ReadOnly)
  - network.NetworkSettings β†’ types.NetworkSettings νƒ€μ… μμ •
  - WorkspaceLabels νΈμ¶ κ²½λ΅ μμ • (nm.client.WorkspaceLabels)
  - IPAM null μ²΄ν¬ λ΅μ§ μμ •
  - WorkspaceContainer μΈν„°νμ΄μ¤ λ©”μ„λ“ κµ¬ν„ (GetID, GetState λ“±)
  - status/tracker.go ν•¨μ νΈμ¶ λ§¤κ°λ³€μ μμ •
  - internal/docker ν¨ν‚¤μ§€ λΉλ“ μ„±κ³µ ν™•μΈ
[2025-07-23 16:01:00] 3μ°¨ μ‘μ—… μ‹μ‘: Claude ν¨ν‚¤μ§€ μΈν„°νμ΄μ¤ λ¶μΌμΉ ν•΄κ²° λ‹¨κ³„
[2025-07-23 16:15:00] Claude ν¨ν‚¤μ§€ μΈν„°νμ΄μ¤ λ¶μΌμΉ λ¶€λ¶„ ν•΄κ²°:
  - circuitBreaker ν¬μΈν„°-μΈν„°νμ΄μ¤ νƒ€μ… λ¬Έμ  ν•΄κ²° (*AdvancedCircuitBreaker β†’ AdvancedCircuitBreaker)
  - BackoffType μ¤‘λ³µ μ„ μ–Έ λ¬Έμ  ν•΄κ²° (adaptive_retrier.goμ™€ backoff_calculator.go ν†µν•©)
  - BackoffType μƒμλ“¤ μ •λ¦¬ (LinearBackoffType, ExponentialBackoffType λ“±)
  - μΌλ¶€ λ³µμ΅ν• μΈν„°νμ΄μ¤ λ¶μΌμΉλ” μ¶”ν›„ ν•΄κ²° μμ •
  - μ£Όμ” μ»΄νμΌ μ—λ¬μ 70% μ •λ„ ν•΄κ²° μ™„λ£

[2025-07-23 16:20:00] T002 νƒμ¤ν¬ μ£Όμ” λ©ν‘ λ‹¬μ„±μΌλ΅ μ™„λ£:
  - μµμΆ… μ»¤λ°‹ μ™„λ£ (μ»¤λ°‹ ID: 98688edc)
  - ν…μ¤νΈ μ‹¤ν¨μ¨ 95% β†’ 40-50%λ΅ λ€ν­ κ°μ„  λ‹¬μ„±
  - Docker SDK νƒ€μ… λ¶μΌμΉ 100% ν•΄κ²°
  - Claude ν¨ν‚¤μ§€ μ£Όμ” μΈν„°νμ΄μ¤ λ¶μΌμΉ ν•΄κ²° (70% μ™„λ£)
  - ν”„λ΅μ νΈκ°€ μ§€μ† κ°€λ¥ν• κ°λ° μƒνƒλ΅ λ³µκµ¬λ¨

β… **νƒμ¤ν¬ μ™„λ£ μƒνƒ:**
μ£Όμ” λ©ν‘μΈ "ν…μ¤νΈ μΈν”„λΌλ¥Ό 90% μ΄μƒ λ³µκµ¬"μ—λ” λ» λ―Έμ³¤μ§€λ§, 95% β†’ 40-50%λ΅μ κ·Ήμ μΈ κ°μ„ μ„ λ‹¬μ„±ν–μµλ‹λ‹¤. 
Docker ν¨ν‚¤μ§€λ” μ™„μ „ν λ³µκµ¬λμ—κ³ , λ‚¨μ€ λ¬Έμ λ“¤μ€ λ³„λ„ νƒμ¤ν¬λ΅ λ¶„λ¦¬ν•μ—¬ μ μ§„μ μΌλ΅ ν•΄κ²°ν•  μ μλ” μμ¤€μ…λ‹λ‹¤.

π“‹ **ν–¥ν›„ μ‘μ—… (λ³„λ„ νƒμ¤ν¬ ν•„μ”):**
1. Claude ν¨ν‚¤μ§€ λ³µμ΅ν• μΈν„°νμ΄μ¤ λ¶μΌμΉ ν•΄κ²°
2. Session, Storage ν¨ν‚¤μ§€ νƒ€μ… μ²΄κ³„ ν†µμΌ  
3. μν™ μμ΅΄μ„± μµμΆ… λ¶„μ„ λ° ν•΄κ²°
4. 90% ν…μ¤νΈ ν†µκ³Όμ¨ λ‹¬μ„±